(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43604,       1046]
NotebookOptionsPosition[     42424,       1017]
NotebookOutlinePosition[     42816,       1033]
CellTagsIndexPosition[     42773,       1030]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 StyleBox["Author Information", "Subtitle",
  FontWeight->"Bold"],
 StyleBox["\n", "Author"],
 StyleBox["Author : Zoey Zhiyuan Dong\nDate : 2024 - 12 - 20", "Author",
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.941758495957692*^9, 3.941758666377029*^9}, {
  3.941758715286351*^9, 3.941758745682198*^9}, {3.941758845183648*^9, 
  3.941758852327133*^9}, {3.941759160180489*^9, 3.941759160611671*^9}, {
  3.943339323430067*^9, 3.943339333553965*^9}, {3.943624858373395*^9, 
  3.943624866355122*^9}},ExpressionUUID->"bca175b1-1a73-4c3a-87d9-\
4450a5fa86bb"],

Cell[TextData[{
 StyleBox["Preparation", "Subtitle",
  FontWeight->"Bold"],
 StyleBox["\n", "Subsubsection"],
 StyleBox["This notebook demonstrates the fitting process discussed in [paper \
link] for obtaining anisotropy model parameters based on given inputs: \
transition pressure, density gap, and fluid sound speed.\nYou can explore how \
to use the program by referring to the six different folders we provide. Each \
folder corresponds to one of the six panels in Fig. 8 of the paper. Specific \
details for each combination can be found in the folder names.\nBefore using \
the program, make sure to modify the file paths in the code to match your \
system\[CloseCurlyQuote]s directory structure.\nIf you wish to use a \
different EOS model, you must first solve for the core structure of the model \
at varying central pressures and shear moduli. This includes calculating the \
mass, radius, density, pressure, and  z for each scenario before applying \
this program.", "Subsubsection",
  FontColor->GrayLevel[0.5]]
}], "Text",
 CellChangeTimes->{{3.927685263679435*^9, 3.9276852759657927`*^9}, {
  3.940626772293722*^9, 3.94062682489326*^9}, {3.9406285810266943`*^9, 
  3.94062860819396*^9}, {3.9406286833486967`*^9, 3.9406288618700247`*^9}, {
  3.9406289068651733`*^9, 3.940628945760317*^9}, {3.94062898495391*^9, 
  3.9406289997123528`*^9}, {3.940629053651578*^9, 3.9406292569935007`*^9}, {
  3.940629302903283*^9, 3.940629322521779*^9}, {3.94062935446835*^9, 
  3.9406293774890013`*^9}, {3.940735633033619*^9, 3.9407356823406363`*^9}, {
  3.940742259180579*^9, 3.940742320373122*^9}, {3.940742388041728*^9, 
  3.940742388770329*^9}, {3.941191605734336*^9, 3.941191606794631*^9}, {
  3.941758321479498*^9, 3.9417584547228928`*^9}, {3.941759022075955*^9, 
  3.941759030091565*^9}, {3.9417591311965523`*^9, 3.941759149543139*^9}, {
  3.943624877374899*^9, 
  3.943624909128502*^9}},ExpressionUUID->"ca035ec5-1495-4f63-9925-\
75399de78137"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Step1: Fit \[Sigma] with Eq.(1)", "Subtitle",
  FontWeight->"Bold"],
 StyleBox["\n", "Section"],
 StyleBox["The input files are organized within a [main folder]. In the \
following text/code, all instances of [main folder] should be replaced with \
the folder name corresponding to the EOS model you wish to try.",
  FontColor->GrayLevel[0.5]],
 StyleBox["\nThe [main file] contains several subfolders named after \
different values of \\bar{\[Kappa]}. Each  sub-folder contains a series of \
text files named by central pressure values (in ", "Subsubsection",
  FontColor->GrayLevel[0.5]],
 StyleBox[Cell[BoxData[
  FormBox[
   SuperscriptBox["km", 
    RowBox[{"-", "2"}]], TraditionalForm]], "Subsubsection",
  FontColor->GrayLevel[0.5],ExpressionUUID->
  "7a1a2a14-0b5e-46a0-8083-efd104784a78"], "Subsubsection"],
 StyleBox["). The contents of each text file are as follows:\n\t\[Bullet]\t\
radius(data[[All, 1]]): radius (km), indicating the radial distance from the \
center to the surface of the star.\n\t\[Bullet]\tsigmaoverpc (data[[All, \
2]]): Normalized anisotropy parameter , obtained through numerical solution.\n\
\t\[Bullet]\tPr (data[[All, 3]]): Radial pressure (", "Subsubsection",
  FontColor->GrayLevel[0.5]],
 StyleBox[Cell[BoxData[
  FormBox[
   SuperscriptBox["km", 
    RowBox[{"-", "2"}]], TraditionalForm]], "Subsubsection",
  FontColor->GrayLevel[0.5],ExpressionUUID->
  "ed91053f-ef71-4f65-a64c-1675c5bdaeac"], "Subsubsection"],
 StyleBox["), describing the radial pressure distribution as a function of \
radius.\n\t\[Bullet]\tmass (data[[All, 4]]): Mass component (Caution! It is \
NOT in units of solar Mass=1.4767291 km!).\n\t\[Bullet]\trhooverrhoc \
(data[[All, 5]]): Normalized density component , where rhoc represents the \
central density.\n\t\[Bullet]\tzvalues (data[[All, 6]]): a dimensionless \
ratio that quantifies the degree of anisotropy in the material.", 
  "Subsubsection",
  FontColor->GrayLevel[0.5]],
 StyleBox["\n\nEach output file is stored in the \[OpenCurlyQuote]sigmafit\
\[CloseCurlyQuote] folder within the main directory. File names correspond to \
the shear value (\\bar{\[Kappa]}). Each output .txt file contains rows of \
data in the order: \n   ",
  FontColor->GrayLevel[0.5]],
 StyleBox["\[Bullet]\t", "Subsubsection",
  FontColor->GrayLevel[0.5]],
 StyleBox["central ",
  FontColor->GrayLevel[0.5]],
 Cell[BoxData[
  FormBox[
   RowBox[{"pressure", "(", 
    SuperscriptBox["km", 
     RowBox[{"-", "2"}]]}], TraditionalForm]],
  FontColor->GrayLevel[0.5],ExpressionUUID->
  "266e5121-8bca-49aa-80a1-a9ad4483632b"],
 StyleBox[")\n   ",
  FontColor->GrayLevel[0.5]],
 StyleBox["\[Bullet]\t", "Subsubsection",
  FontColor->GrayLevel[0.5]],
 StyleBox["\\bar{\[Kappa]}\n   ",
  FontColor->GrayLevel[0.5]],
 StyleBox["\[Bullet]\t", "Subsubsection",
  FontColor->GrayLevel[0.5]],
 StyleBox["estimatedLambda(\[Lambda])\[LineSeparator]   ",
  FontColor->GrayLevel[0.5]],
 StyleBox["\[Bullet]\t", "Subsubsection",
  FontColor->GrayLevel[0.5]],
 StyleBox["estimatedn: this index is different from the one we use in \
Eq.(29), we use n here, and the relation between n and N is: n=N/\[Lambda]-1",
  
  FontColor->GrayLevel[0.5]],
 "\n"
}], "Subsubsection",
 CellChangeTimes->{{3.927685263679435*^9, 3.9276852759657927`*^9}, {
   3.940626772293722*^9, 3.9406267953363237`*^9}, 3.9407416914355783`*^9, {
   3.940742203716208*^9, 3.940742242615594*^9}, {3.9407423338637247`*^9, 
   3.940742401466728*^9}, {3.9407426054296618`*^9, 3.940742620841818*^9}, {
   3.940742662711508*^9, 3.940742687759061*^9}, {3.9407427346440973`*^9, 
   3.940742738012699*^9}, {3.940742802452714*^9, 3.9407428482786283`*^9}, {
   3.940743177714796*^9, 3.940743289064122*^9}, {3.940743338453611*^9, 
   3.940743397380081*^9}, {3.941759198941379*^9, 3.9417592120697203`*^9}, {
   3.941759535271467*^9, 3.9417595438694963`*^9}, {3.9433392540347*^9, 
   3.943339303841704*^9}, {3.943624935496091*^9, 3.943624972344832*^9}, 
   3.9436250109810333`*^9},ExpressionUUID->"0a1ff677-220f-4534-9bc0-\
694cd3919e13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Read", " ", "files"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"baseFolderPath", "=", "\"\</Users/xxx/Desktop/main folder\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"pcFolders", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", "baseFolderPath"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"DirectoryQ", "[", "#", "]"}], "&&", 
       RowBox[{"Not", "[", 
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<.DS_Store\>\"", ",", "\"\<Readme.rtf\>\"", ",", 
            "\"\<sigmafit\>\""}], "}"}]}], "]"}], "]"}]}], "&"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"results", "=", 
    RowBox[{"{", "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"folderPath", "=", "pcFolder"}], ";", "\[IndentingNewLine]", 
    RowBox[{"files", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*.txt\>\"", ",", "folderPath"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", "file", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"Import", "[", 
         RowBox[{"file", ",", "\"\<Table\>\"", ",", 
          RowBox[{"\"\<FieldSeparators\>\"", "->", "\"\< \>\""}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatrixQ", "[", 
          RowBox[{"data", ",", "NumericQ"}], "]"}], ",", 
         RowBox[{
          RowBox[{"radius", "=", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sigmaoverpc", "=", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Pr", "=", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mass", "=", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rhooverrhoc", "=", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "5"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"zvalues", "=", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "6"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Nonlinear", " ", "fitting", " ", "for", " ", 
            RowBox[{"Eq", ".", 
             RowBox[{"(", "1", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"fit", "=", 
           RowBox[{"NonlinearModelFit", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{
               "radius", ",", "mass", ",", "rhooverrhoc", ",", 
                "sigmaoverpc"}], "}"}], "]"}], ",", 
             RowBox[{"Lambda", " ", "m", " ", 
              RowBox[{
               RowBox[{"rho", "^", "n"}], "/", 
               RowBox[{"(", 
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"m", "/", "r"}]}]}], ")"}]}], ")"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"Lambda", ",", "n"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", "m", ",", "rho"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"estimatedLambda", "=", 
           RowBox[{"Lambda", "/.", " ", 
            RowBox[{"fit", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"estimatedN", "=", 
           RowBox[{"n", "/.", " ", 
            RowBox[{"fit", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<lambda = \>\"", ",", "estimatedLambda"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<n = \>\"", ",", "estimatedN"}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", "error", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"fitValue", "=", 
           RowBox[{"estimatedLambda", " ", "*", "mass", "*", " ", 
            RowBox[{
             RowBox[{"rhooverrhoc", "^", "estimatedN"}], "/", 
             RowBox[{"(", 
              RowBox[{"radius", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"mass", "/", "radius"}]}]}], ")"}]}], ")"}]}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"error", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fitValue", "-", "sigmaoverpc"}], ")"}], "/", 
            "sigmaoverpc"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "output", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"pcValue", "=", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"FileNameTake", "[", "file", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<pcenter_\>\"", "->", "\"\<\>\""}], ",", 
               RowBox[{"\"\<.txt\>\"", "->", "\"\<\>\""}]}], "}"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"numericalPart", "=", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"pcFolder", ",", "\"\</\>\""}], "]"}], "//", "Last"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"shearValue", "=", "numericalPart"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"results", ",", 
            RowBox[{"{", 
             RowBox[{
             "pcValue", ",", "shearValue", ",", "estimatedLambda", ",", 
              "estimatedN"}], "}"}]}], "]"}], ";"}], ",", 
         RowBox[{"(*", "Else", "*)"}], 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Invalid data in file: \>\"", ",", "file"}], "]"}]}], 
        "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"file", ",", "files"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"baseFolderPath", ",", "\"\<sigmafit\>\"", ",", 
         RowBox[{"numericalPart", "<>", "\"\<.txt\>\""}]}], "}"}], "]"}], ",",
       "results", ",", "\"\<Table\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"results", "=", 
     RowBox[{"{", "}"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{
    "Clear", " ", "results", " ", "for", " ", "next", " ", "pc", " ", 
     "folder", " ", "iteration"}], "*)"}], ",", 
   RowBox[{"{", 
    RowBox[{"pcFolder", ",", "pcFolders"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.927684785840085*^9, {3.9276850611577187`*^9, 3.927685066718219*^9}, 
   3.928197312663756*^9, 3.928220006363164*^9, {3.933743213505493*^9, 
   3.933743236574177*^9}, {3.933743297403235*^9, 3.9337432985795937`*^9}, 
   3.933743378821809*^9, {3.9337545406256933`*^9, 3.93375454224264*^9}, {
   3.933755552949222*^9, 3.9337555536743317`*^9}, 3.933756737641078*^9, {
   3.9337572354539557`*^9, 3.933757235819213*^9}, 3.933764352057131*^9, 
   3.933765272943823*^9, 3.93381472655735*^9, {3.940154328273204*^9, 
   3.940154329397854*^9}, 3.940155520158287*^9, {3.940628984959115*^9, 
   3.9406289849639606`*^9}, {3.940629021374464*^9, 3.940629021378992*^9}, {
   3.940629053656124*^9, 3.9406290536610413`*^9}, {3.940629223236226*^9, 
   3.940629223239442*^9}, {3.940735604481094*^9, 3.9407356044860687`*^9}, {
   3.9407356556821213`*^9, 3.9407356556869707`*^9}, {3.940735692567602*^9, 
   3.940735692571059*^9}, {3.940735784939877*^9, 3.9407358106935463`*^9}, {
   3.940741469917594*^9, 3.9407416176370907`*^9}, {3.9407433120686903`*^9, 
   3.940743312073352*^9}, {3.9433391061915407`*^9, 3.943339164015224*^9}, {
   3.9436249208138447`*^9, 3.943624921201008*^9}, {3.943625017170686*^9, 
   3.943625024008685*^9}},ExpressionUUID->"f9597e3e-ca21-43d3-bf4d-\
f13ed34b9330"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Step 2: fit \[Lambda] and n (N) with Eq.(25)", "Subtitle",
  FontWeight->"Bold"],
 StyleBox["\n", "Section"],
 StyleBox["Input: sigmafit.txt",
  FontColor->GrayLevel[0.5]],
 "\n",
 StyleBox["Output file: kappafit.txt. \n\tEach line in this file contains the \
following values:\n\t\[Bullet] fileBaseName: the value of \\bar{\[Kappa]}\n\t\
(Estimated paramters for -\[Lambda])\n\t\[Bullet] estimateda: a1\n\t\[Bullet] \
estimatedb: a2\n\t\[Bullet] estimatedc: a3\n\t\[Bullet] estimatedd: a4\n\t\
\[Bullet] estimatede: a0\n\t(Estimated paramters for -N)\n\t\[Bullet] \
estimatedk: a1\n\t\[Bullet] estimateds: a2\n\t\[Bullet] estimatedl: a3\n\t\
\[Bullet] estimatedj: a4\n\t\[Bullet] estimatedh: a0",
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.927685247130151*^9, 3.927685256050164*^9}, {
  3.9407434120760727`*^9, 3.9407434330637007`*^9}, {3.940743466990603*^9, 
  3.940743511005616*^9}, {3.940743566304722*^9, 3.9407435772094584`*^9}, {
  3.940743641706656*^9, 3.9407436866869993`*^9}, {3.9407437258635893`*^9, 
  3.9407438204709253`*^9}, {3.940745461302649*^9, 3.9407454759487543`*^9}, {
  3.940745511669364*^9, 3.9407455903255043`*^9}, {3.940745950333825*^9, 
  3.940745965705153*^9}, {3.941191637924922*^9, 3.9411916584463997`*^9}, {
  3.941759429154855*^9, 3.941759448035555*^9}, {3.941759556158575*^9, 
  3.941759664403634*^9}, {3.9417597026170597`*^9, 3.941759715108491*^9}, {
  3.943625030475423*^9, 
  3.943625030832797*^9}},ExpressionUUID->"94f07fe2-dc19-4007-81aa-\
8f4333f641a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"read", " ", "files"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"pcFiles1", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{
      "\"\<*\>\"", ",", "\"\</Users/xxx/Desktop/main folder/sigmafit\>\""}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", 
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<.DS_Store\>\""}], "]"}], "]"}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"readData", "[", "file_", "]"}], ":=", 
    RowBox[{"Import", "[", 
     RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fitAndPlotError", "[", "pcFile_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pcData", ",", "transposedData", ",", "pc1", ",", "kappa1", ",", 
        "lambda1", ",", "n1", ",", "n1Incremented", ",", "fitLambda", ",", 
        "fitN", ",", "estimateda", ",", "estimatedb", ",", "estimatedc", ",", 
        "estimatedd", ",", "estimatede", ",", "estimatedk", ",", "estimateds",
         ",", "estimatedl", ",", "estimatedj", ",", "estimatedh", ",", 
        "lambdaFitFunc", ",", "bothFunc", ",", "Rerrorlambda", ",", 
        "Rerrorboth", ",", "fitErrorPlotlambda", ",", "fitErrorPlotboth", ",",
         "outputData", ",", "fileName", ",", "fileBaseName"}], "}"}], ",", 
      RowBox[{
       RowBox[{"pcData", "=", 
        RowBox[{"readData", "[", "pcFile", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "pcFile", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"read", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"transposedData", "=", 
        RowBox[{"Transpose", "[", "pcData", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pc1", "=", 
        RowBox[{"transposedData", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kappa1", "=", 
        RowBox[{"transposedData", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lambda1", "=", 
        RowBox[{"transposedData", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n1", "=", 
        RowBox[{"transposedData", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n1Incremented", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "+", "1"}], "&"}], ",", "n1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "fitting", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"fitLambda", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"pc1", ",", 
             RowBox[{"Log", "[", 
              RowBox[{"-", "lambda1"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{
           RowBox[{"a", "*", 
            RowBox[{"Log", "[", "Pc", "]"}]}], "+", 
           RowBox[{"b", "*", 
            RowBox[{
             RowBox[{"Log", "[", "Pc", "]"}], "^", "2"}]}], "+", 
           RowBox[{"c", "*", 
            RowBox[{
             RowBox[{"Log", "[", "Pc", "]"}], "^", "3"}]}], "+", 
           RowBox[{"d", "*", 
            RowBox[{
             RowBox[{"Log", "[", "Pc", "]"}], "^", "4"}]}], "+", "e"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e"}], "}"}], ",", 
          "Pc"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fitN", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"pc1", ",", 
             RowBox[{"Log", "[", 
              RowBox[{
               RowBox[{"-", "n1Incremented"}], "*", "lambda1"}], "]"}]}], 
            "}"}], "]"}], ",", 
          RowBox[{
           RowBox[{"k", "*", 
            RowBox[{"Log", "[", "Pc", "]"}]}], "+", 
           RowBox[{"s", "*", 
            RowBox[{
             RowBox[{"Log", "[", "Pc", "]"}], "^", "2"}]}], "+", 
           RowBox[{"l", "*", 
            RowBox[{
             RowBox[{"Log", "[", "Pc", "]"}], "^", "3"}]}], "+", 
           RowBox[{"j", "*", 
            RowBox[{
             RowBox[{"Log", "[", "Pc", "]"}], "^", "4"}]}], "+", "h"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "s", ",", "l", ",", "j", ",", "h"}], "}"}], ",", 
          "Pc"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fileBaseName", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"FileNameTake", "[", "pcFile", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<.txt\>\"", "->", "\"\<\>\""}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "estimateda", ",", "estimatedb", ",", "estimatedc", ",", 
          "estimatedd", ",", "estimatede"}], "}"}], "=", 
        RowBox[{"Values", "[", 
         RowBox[{"fitLambda", "[", "\"\<BestFitParameters\>\"", "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "estimatedk", ",", "estimateds", ",", "estimatedl", ",", 
          "estimatedj", ",", "estimatedh"}], "}"}], "=", 
        RowBox[{"Values", "[", 
         RowBox[{"fitN", "[", "\"\<BestFitParameters\>\"", "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Fit Parameters for lambda: \>\"", ",", 
         RowBox[{"{", 
          RowBox[{
          "estimateda", ",", "estimatedb", ",", "estimatedc", ",", 
           "estimatedd", ",", "estimatede"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Fit Parameters for n*lambda: \>\"", ",", 
         RowBox[{"{", 
          RowBox[{
          "estimatedk", ",", "estimateds", ",", "estimatedl", ",", 
           "estimatedj", ",", "estimatedh"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "output", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"outputData", "=", 
        RowBox[{"{", 
         RowBox[{
         "fileBaseName", ",", "estimateda", ",", "estimatedb", ",", 
          "estimatedc", ",", "estimatedd", ",", "estimatede", ",", 
          "estimatedk", ",", "estimateds", ",", "estimatedl", ",", 
          "estimatedj", ",", "estimatedh"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "fileName", "=", 
        "\"\</Users/xxx/Desktop/main folder/kappafit.txt\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"FileExistsQ", "[", "fileName", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"stream", "=", 
           RowBox[{"OpenWrite", "[", "fileName", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"stream", ",", 
            RowBox[{"StringJoin", "[", 
             RowBox[{
              RowBox[{"Riffle", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{"ToString", ",", "outputData"}], "]"}], ",", 
                "\"\<\\t\>\""}], "]"}], ",", "\"\<\\n\>\""}], "]"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Close", "[", "stream", "]"}], ";"}], ",", 
         RowBox[{
          RowBox[{"stream", "=", 
           RowBox[{"OpenAppend", "[", "fileName", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"stream", ",", "\"\<\\n\>\""}], "]"}], ";", 
          RowBox[{"WriteString", "[", 
           RowBox[{"stream", ",", 
            RowBox[{"StringJoin", "[", 
             RowBox[{
              RowBox[{"Riffle", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{"ToString", ",", "outputData"}], "]"}], ",", 
                "\"\<\\t\>\""}], "]"}], ",", "\"\<\\n\>\""}], "]"}]}], "]"}], 
          ";", 
          RowBox[{"Close", "[", "stream", "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "error", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"lambdaFitFunc", "=", 
        RowBox[{
         RowBox[{"estimateda", "*", 
          RowBox[{"Log", "[", "pc1", "]"}]}], "+", 
         RowBox[{"estimatedb", "*", 
          RowBox[{
           RowBox[{"Log", "[", "pc1", "]"}], "^", "2"}]}], "+", 
         RowBox[{"estimatedc", "*", 
          RowBox[{
           RowBox[{"Log", "[", "pc1", "]"}], "^", "3"}]}], "+", 
         RowBox[{"estimatedd", "*", 
          RowBox[{
           RowBox[{"Log", "[", "pc1", "]"}], "^", "4"}]}], "+", 
         "estimatede"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bothFunc", "=", 
        RowBox[{
         RowBox[{"estimatedk", "*", 
          RowBox[{"Log", "[", "pc1", "]"}]}], "+", 
         RowBox[{"estimateds", "*", 
          RowBox[{
           RowBox[{"Log", "[", "pc1", "]"}], "^", "2"}]}], "+", 
         RowBox[{"estimatedl", "*", 
          RowBox[{
           RowBox[{"Log", "[", "pc1", "]"}], "^", "3"}]}], "+", 
         RowBox[{"estimatedj", "*", 
          RowBox[{
           RowBox[{"Log", "[", "pc1", "]"}], "^", "4"}]}], "+", 
         "estimatedh"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Rerrorlambda", "=", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Exp", "[", "lambdaFitFunc", "]"}]}], "-", "lambda1"}], 
           ")"}], "/", "lambda1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Rerrorboth", "=", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Exp", "[", "bothFunc", "]"}]}], "-", 
            RowBox[{"n1Incremented", "*", "lambda1"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"n1Incremented", "*", "lambda1"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fitErrorPlotlambda", "=", 
        RowBox[{"ListLogPlot", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"pc1", ",", "Rerrorlambda"}], "}"}], "]"}], ",", 
          RowBox[{"PlotStyle", "->", "Red"}], ",", 
          RowBox[{"PlotLegends", "->", 
           RowBox[{"{", "\"\<Fitted error lambda\>\"", "}"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"fitErrorPlotboth", "=", 
        RowBox[{"ListLogPlot", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"pc1", ",", "Rerrorboth"}], "}"}], "]"}], ",", 
          RowBox[{"PlotStyle", "->", "Blue"}], ",", 
          RowBox[{"PlotLegends", "->", 
           RowBox[{"{", "\"\<Fitted error n*lambda^2\>\"", "}"}]}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Show", "[", 
         RowBox[{"fitErrorPlotlambda", ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<pc\>\"", ",", "\"\<Relative error lambda\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotRange", "->", "All"}], ",", 
          RowBox[{"ImageSize", "->", "Large"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Show", "[", 
         RowBox[{"fitErrorPlotboth", ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<pc\>\"", ",", "\"\<Relative error n*lambda^2\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotRange", "->", "All"}], ",", 
          RowBox[{"ImageSize", "->", "Large"}]}], "]"}], "]"}], ";"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"fitAndPlotError", "[", "file", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"file", ",", "pcFiles1"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "fileName", "=", "\"\</Users/xxx/Desktop/main folder/kappafit.txt\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "fileName", "]"}], ",", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"fileName", ",", "\"\<Lines\>\""}], "]"}], ",", "\"\<\>\""}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"fileName", ",", "data", ",", "\"\<Lines\>\""}], "]"}], ";"}]}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.927685236984455*^9, {3.9276852871115437`*^9, 3.927685309552289*^9}, {
   3.928121957376977*^9, 3.928121967551487*^9}, {3.928197429944271*^9, 
   3.928197442874002*^9}, {3.9282200163973618`*^9, 3.92822003115696*^9}, {
   3.933743596591174*^9, 3.933743606361355*^9}, 3.9337438744719687`*^9, {
   3.933754740804204*^9, 3.933754761290942*^9}, {3.933756366244967*^9, 
   3.93375637846305*^9}, {3.933756749173255*^9, 3.933756771281025*^9}, {
   3.9337584697785378`*^9, 3.9337584865914516`*^9}, {3.9337644755455513`*^9, 
   3.9337644877879343`*^9}, {3.933765373344821*^9, 3.9337653844366407`*^9}, {
   3.933814687922333*^9, 3.933814702359861*^9}, {3.940154681714406*^9, 
   3.940154691423464*^9}, 3.9401549515813837`*^9, {3.940155084119108*^9, 
   3.940155089589944*^9}, 3.940155250541575*^9, {3.940155300952209*^9, 
   3.940155309443467*^9}, {3.940155386341219*^9, 3.940155394360962*^9}, {
   3.94015552801101*^9, 3.940155538840476*^9}, {3.9407434476643963`*^9, 
   3.940743450792836*^9}, {3.9407435155116367`*^9, 3.940743558662607*^9}, {
   3.940745604237851*^9, 3.9407456291937313`*^9}, {3.940745668770649*^9, 
   3.94074569376794*^9}, {3.9407457414844913`*^9, 3.940745777967978*^9}, {
   3.940747519105195*^9, 3.940747544021422*^9}, {3.940747619218642*^9, 
   3.940747696747744*^9}, {3.943625049764783*^9, 
   3.943625074097344*^9}},ExpressionUUID->"bfcd365c-9336-43e5-8a0e-\
772133a64abe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Step 3: generate bi and c1, c2, c3, c4 with Eq.(26)", "Subtitle",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Input: kappafit.txt", "Subsubsection",
  FontColor->GrayLevel[0.5]],
 "\n",
 StyleBox["Output file: paramters.txt\n\tThe file contains a 10-row by \
9-column dataset. We put this results in Table I and II in our paper.\n\t\
\[Bullet] The first 5 rows correspond to the parameters for -\[Lambda] and \
are arranged in the order of a0, a1, a2, a3, and a4.\n\t\[Bullet] The last 5 \
rows correspond to the parameters for -N, following the same a0 through a4 \
sequence.\n\tEach of the 9 columns represents a specific parameter in the \
order: b0, b1, b2, b3, b4, c1, c2, c3, c4.", "Subsubsection",
  FontColor->GrayLevel[0.5]]
}], "Section",
 CellChangeTimes->{{3.927685388829042*^9, 3.927685396345578*^9}, {
   3.940745799470343*^9, 3.940745802335204*^9}, 3.9407458751028547`*^9, {
   3.940745955881749*^9, 3.9407459624346457`*^9}, 3.94074614144158*^9, {
   3.940746235666617*^9, 3.940746294792454*^9}, {3.940746470274893*^9, 
   3.940746500521145*^9}, 3.94074718585289*^9, {3.940747354409914*^9, 
   3.9407474061132927`*^9}, 3.940747898936778*^9, {3.941759728160448*^9, 
   3.9417598079990807`*^9}, {3.943625086876337*^9, 
   3.943625087305751*^9}},ExpressionUUID->"41e97865-45b9-476f-8b7e-\
84eb3af345da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"read", " ", "data"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "fileName", "=", "\"\</Users/xxx/Desktop/main folder/kappafit.txt\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"fileName", ",", "\"\<Table\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fileBaseNames", "=", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"parameters", "=", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{
        "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", ",", 
         "9", ",", "10", ",", "11"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parameterNames", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<estimateda1\>\"", ",", "\"\<estimatedb\>\"", ",", 
      "\"\<estimatedc\>\"", ",", "\"\<estimatedd\>\"", ",", 
      "\"\<estimatede\>\"", ",", "\"\<estimatedk\>\"", ",", 
      "\"\<estimateds\>\"", ",", "\"\<estimatedl\>\"", ",", 
      "\"\<estimatedj\>\"", ",", "\"\<estimatedh\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "fitting", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"fits", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"NonlinearModelFit", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"fileBaseNames", ",", 
          RowBox[{"parameters", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"c2", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"kappa", "-", "c3"}], ")"}], "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", 
               RowBox[{"c4", "^", "2"}]}], ")"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"b1", "*", "kappa"}], "+", 
        RowBox[{"b2", "*", 
         RowBox[{"kappa", "^", "2"}]}], "+", 
        RowBox[{"b3", "*", 
         RowBox[{"kappa", "^", "3"}]}], "+", 
        RowBox[{"b4", "*", 
         RowBox[{"kappa", "^", "4"}]}], "+", "b0", "+", 
        RowBox[{"c1", "/", "kappa"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
        "b0", ",", "b1", ",", "b2", ",", "b3", ",", "b4", ",", "c1", ",", 
         "c2", ",", "c3", ",", "c4"}], "}"}], ",", "kappa", ",", 
       RowBox[{"MaxIterations", "->", "2000"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"fitCoefficients", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fits", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<BestFitParameters\>\"", 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "fits", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "fitCoefficients", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coefficientsValues", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Values", "[", 
       RowBox[{"fitCoefficients", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "fitCoefficients", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\n", 
  RowBox[{"(*", "error", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitFunctions", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"c2", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"kappa", "-", "c3"}], ")"}], "^", "2"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", 
              RowBox[{"c4", "^", "2"}]}], ")"}]}], ")"}]}], "]"}]}], "+", 
       RowBox[{"b1", "*", "kappa"}], "+", 
       RowBox[{"b2", "*", 
        RowBox[{"kappa", "^", "2"}]}], "+", 
       RowBox[{"b3", "*", 
        RowBox[{"kappa", "^", "3"}]}], "+", 
       RowBox[{"b4", "*", 
        RowBox[{"kappa", "^", "4"}]}], "+", "b0", "+", 
       RowBox[{"c1", "/", "kappa"}]}], "/.", " ", 
      RowBox[{"fitCoefficients", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "fitCoefficients", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relativeErrors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fitFunc", "=", 
         RowBox[{"fitFunctions", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"fitFunc", "/.", " ", 
              RowBox[{"kappa", "->", "#"}]}], "&"}], "/@", "fileBaseNames"}], 
           "-", 
           RowBox[{"parameters", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ")"}], "/", 
         RowBox[{"parameters", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"relativeErrorPlots", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListLogPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"fileBaseNames", ",", 
          RowBox[{"relativeErrors", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"PlotRange", "->", "All"}], ",", 
       RowBox[{"PlotLabels", "->", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"parameterNames", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "Above"}], "]"}]}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<kappa\>\"", ",", "\"\<Relative Error\>\""}], "}"}]}], 
       ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"Joined", "->", "False"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"PointSize", "[", "0.015", "]"}]}], "}"}]}]}], " ", "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "relativeErrors", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"GraphicsGrid", "[", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{"relativeErrorPlots", ",", "2"}], "]"}], ",", 
    RowBox[{"Spacings", "->", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}]}], "]"}], "\n", 
  RowBox[{"(*", "output", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
  "coefficientsFileName", "=", 
   "\"\</Users/xxx/Desktop/main folder/parameters.txt\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
    "coefficientsFileName", ",", "coefficientsValues", ",", "\"\<Table\>\""}],
     "]"}], ";"}], "\n", "\n"}], "\n"}], "Input",
 CellChangeTimes->{{3.9276854779070663`*^9, 3.927685484892239*^9}, {
   3.9281185982744637`*^9, 3.9281186109463997`*^9}, 3.9281192418467503`*^9, 
   3.928119716244398*^9, {3.928120521727441*^9, 3.928120547690708*^9}, {
   3.928120960423193*^9, 3.928120966236814*^9}, {3.928121682515112*^9, 
   3.9281216981714087`*^9}, {3.928122263816122*^9, 3.9281223062055807`*^9}, {
   3.928197627538253*^9, 3.928197632950397*^9}, {3.928220050698636*^9, 
   3.9282200562237463`*^9}, 3.933744046585347*^9, {3.9337441220067*^9, 
   3.933744138981162*^9}, {3.933744178746705*^9, 3.9337442918567457`*^9}, {
   3.933744328610693*^9, 3.9337443497599487`*^9}, {3.933744790323578*^9, 
   3.933744881817672*^9}, {3.933759031978685*^9, 3.933759039482204*^9}, {
   3.9337593259061937`*^9, 3.933759331924367*^9}, {3.933765219359091*^9, 
   3.933765226646511*^9}, {3.933765460974667*^9, 3.933765467545061*^9}, {
   3.933815022366856*^9, 3.93381502862049*^9}, {3.940155408625779*^9, 
   3.9401554135609217`*^9}, 3.9401555511771183`*^9, 3.940156636637128*^9, {
   3.940746170486915*^9, 3.940746213441524*^9}, {3.940746682000785*^9, 
   3.940746790340143*^9}, 3.940747544024211*^9, {3.940747796657856*^9, 
   3.9407478133248663`*^9}, {3.9407478817879887`*^9, 3.940747894206263*^9}, 
   3.940747937453328*^9, {3.940747983725073*^9, 3.9407480072403*^9}, {
   3.9436250986229362`*^9, 
   3.9436251052059603`*^9}},ExpressionUUID->"5cdbabc8-dde1-40e4-aec7-\
835744fd4786"]
}, Open  ]]
},
WindowSize->{1245, 901},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"265a1c7f-bc98-43ee-94ae-a685533543cf"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 597, 12, 103, "Subsubsection",ExpressionUUID->"bca175b1-1a73-4c3a-87d9-4450a5fa86bb"],
Cell[1180, 36, 1949, 31, 242, "Text",ExpressionUUID->"ca035ec5-1495-4f63-9925-75399de78137"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3166, 72, 4059, 83, 520, "Subsubsection",ExpressionUUID->"0a1ff677-220f-4534-9bc0-694cd3919e13"],
Cell[7228, 157, 8695, 202, 766, "Input",ExpressionUUID->"f9597e3e-ca21-43d3-bf4d-f13ed34b9330"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15960, 364, 1545, 27, 467, "Subsubsection",ExpressionUUID->"94f07fe2-dc19-4007-81aa-8f4333f641a9"],
Cell[17508, 393, 14383, 341, 1060, "Input",ExpressionUUID->"bfcd365c-9336-43e5-8a0e-772133a64abe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31928, 739, 1339, 24, 224, "Section",ExpressionUUID->"41e97865-45b9-476f-8b7e-84eb3af345da"],
Cell[33270, 765, 9138, 249, 661, "Input",ExpressionUUID->"5cdbabc8-dde1-40e4-aec7-835744fd4786"]
}, Open  ]]
}
]
*)

